---
phase: 01-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - app/page.tsx
  - app/components/AnimatedBackground.tsx
  - app/components/HomepageSignup.tsx
autonomous: true

must_haves:
  truths:
    - "Homepage HTML source contains meaningful text (STREET heading, teaser tagline) without JS execution"
    - "Homepage waitlist form still submits name+email to Airtable successfully"
    - "JS bundle stays under 150KB compressed (verified via next build output)"
    - "Page renders without errors in both JS-enabled and view-source contexts"
  artifacts:
    - path: "app/page.tsx"
      provides: "Server component with semantic HTML structure"
      contains: "export default function"
    - path: "app/components/AnimatedBackground.tsx"
      provides: "TV static canvas + image flash animation"
      contains: "'use client'"
    - path: "app/components/HomepageSignup.tsx"
      provides: "Inline waitlist form (name + email)"
      contains: "'use client'"
  key_links:
    - from: "app/page.tsx"
      to: "app/components/AnimatedBackground.tsx"
      via: "import and render as child"
      pattern: "import AnimatedBackground"
    - from: "app/page.tsx"
      to: "app/components/HomepageSignup.tsx"
      via: "import and render as child"
      pattern: "import HomepageSignup"
    - from: "app/components/HomepageSignup.tsx"
      to: "/api/waitlist"
      via: "fetch POST on form submit"
      pattern: "fetch.*api/waitlist"
---

<objective>
Restructure the homepage from a monolithic client component into a server/client architecture with meaningful HTML.

Purpose: The current `app/page.tsx` is entirely `'use client'` — zero HTML reaches crawlers or screen readers without JS. This plan splits it into a server component (semantic HTML) with client components layered on top (animations, form), satisfying PERF-02 (LCP) and PERF-04 (meaningful HTML).

Output: Server-rendered homepage with extracted AnimatedBackground and HomepageSignup client components.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/codebase/CONVENTIONS.md
@.planning/codebase/STRUCTURE.md

@app/page.tsx
@app/layout.tsx
@app/api/waitlist/route.ts
@app/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extract client components and restructure homepage as server component</name>
  <files>app/page.tsx, app/components/AnimatedBackground.tsx, app/components/HomepageSignup.tsx</files>
  <action>
    **Create `app/components/AnimatedBackground.tsx`** as `'use client'`:
    - Extract the TV static canvas logic (canvasRef, renderStatic, staticIntensity breathing)
    - Extract the image flash sequence (FLASH_IMAGES, phase state machine)
    - Component renders: the flash image div + the canvas element
    - Keep the existing CSS class names (`mystery-flash-image`, `mystery-static`)
    - The component is a visual overlay with no semantic content — it sits behind the main content via CSS positioning

    **Create `app/components/HomepageSignup.tsx`** as `'use client'`:
    - Extract the waitlist form logic (name, email, formState, handleSubmit)
    - Component renders: the form with name input, email input, submit button, success/error states
    - Keep the existing CSS class names (`mystery-form`, `mystery-input`, `mystery-submit`, `mystery-error`, `mystery-success`)
    - POST to `/api/waitlist` with `{ name, email }` — identical to current behavior
    - The API route (`app/api/waitlist/route.ts`) is NOT modified — it already handles `{ name, email }` submissions

    **Rewrite `app/page.tsx`** as a server component (remove `'use client'`):
    - Remove ALL React hooks (useState, useEffect, useRef) — these move to client components
    - Import and render `AnimatedBackground` and `HomepageSignup`
    - Add semantic HTML structure:
      ```
      <main> with mystery-container class
        <AnimatedBackground />  (visual overlay, positioned absolute behind content)
        <div mystery-content>
          <h1 mystery-logo>STREET</h1>
          <p mystery-tagline>Something is coming.</p>  ← NEW: meaningful text for crawlers
          <HomepageSignup />
        </div>
      </main>
      ```
    - The tagline "Something is coming." is placeholder text — Phase 3 will replace it with cinematic sequence content. For now it ensures PERF-04 (meaningful HTML in DOM).
    - Use `<main>` instead of `<div>` for the outer container (better semantics)

    **CSS class for tagline:** Add a `mystery-tagline` class in globals.css:
    - Color: rgba(255,255,255,0.5) — subtle, not competing with STREET heading
    - Font-size: 1rem, letter-spacing: 0.2em, text-transform: uppercase
    - Margin-top: 0.5rem below the heading
    - This is minimal styling — Phase 2 will refine the visual atmosphere
  </action>
  <verify>
    - `npm run build` succeeds without errors
    - Check build output: First Load JS for homepage route should be under 150KB
    - `curl http://localhost:3000 2>/dev/null | grep -i "STREET"` shows the heading in HTML source (not just client-rendered)
    - `curl http://localhost:3000 2>/dev/null | grep -i "something is coming"` shows tagline in HTML source
  </verify>
  <done>
    - Homepage is a server component with AnimatedBackground and HomepageSignup as client children
    - HTML source contains "STREET" heading and "Something is coming." tagline without JS
    - Build output shows homepage First Load JS under 150KB
    - Form submission to /api/waitlist still works (name + email → Airtable)
  </done>
</task>

<task type="auto">
  <name>Task 2: Verify performance baseline</name>
  <files>app/page.tsx</files>
  <action>
    Run `npm run build` and capture the route-level bundle analysis from the build output.

    Check the homepage (`/`) route:
    - **First Load JS** must be under 150KB (PERF-01 requirement)
    - If over 150KB, investigate what's pulling in extra weight (lucide-react? swiper? — neither should be on homepage)

    Start dev server and verify:
    - Homepage loads without console errors
    - TV static animation still plays
    - Image flashing still works
    - Form accepts name + email and submits successfully
    - After submission, success message "We'll be in touch." appears

    If build or runtime issues found, fix them before marking done. Common issues:
    - Server component accidentally importing client-only code → add 'use client' to the right file
    - Missing props between server and client components → check component interfaces
    - CSS classes not matching after restructure → verify class names are identical
  </action>
  <verify>
    - `npm run build` output shows homepage route First Load JS < 150KB
    - Dev server: homepage loads, animations play, form submits successfully
    - No TypeScript or ESLint errors
  </verify>
  <done>
    - Build passes with homepage JS under 150KB compressed
    - All existing homepage functionality preserved (static animation, form submission)
    - No new errors introduced
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] Homepage First Load JS < 150KB in build output
- [ ] `curl localhost:3000` shows "STREET" and "Something is coming" in HTML source
- [ ] Form submission works end-to-end (name + email → API → response)
- [ ] No TypeScript errors (`npx tsc --noEmit`)
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Homepage serves meaningful HTML from server
- Client components hydrate without errors
- Waitlist form still works identically
- Bundle size under 150KB compressed
  </success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
