---
phase: 01-foundation
plan: 02
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - app/globals.css
  - app/components/AnimatedBackground.tsx
autonomous: true

must_haves:
  truths:
    - "Users with prefers-reduced-motion see a complete static experience with heading, tagline, and working form"
    - "No animations (canvas, image flashing) play when prefers-reduced-motion is set"
    - "The static fallback looks intentional and styled — not broken or blank"
    - "Page scores >80 on Lighthouse Performance (mobile)"
  artifacts:
    - path: "app/globals.css"
      provides: "prefers-reduced-motion media query rules"
      contains: "prefers-reduced-motion"
    - path: "app/components/AnimatedBackground.tsx"
      provides: "JS-level reduced-motion detection that skips animation setup"
      contains: "prefers-reduced-motion"
  key_links:
    - from: "app/globals.css"
      to: "AnimatedBackground.tsx"
      via: "CSS hides canvas and flash images when reduced-motion active"
      pattern: "prefers-reduced-motion.*mystery-static"
    - from: "app/components/AnimatedBackground.tsx"
      to: "window.matchMedia"
      via: "JS check skips requestAnimationFrame loop"
      pattern: "matchMedia.*prefers-reduced-motion"
---

<objective>
Add prefers-reduced-motion support so users who prefer reduced motion see a complete, styled, static experience.

Purpose: PERF-03 requires that `prefers-reduced-motion` users see "an elegant static fallback (not broken/blank)." Currently there is zero reduced-motion handling. This plan adds both CSS-level and JS-level support, preventing canvas animation from running and ensuring all content is visible statically.

Output: Fully accessible reduced-motion experience + verified Lighthouse performance score.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@.planning/phases/01-foundation/01-01-SUMMARY.md

@app/page.tsx
@app/components/AnimatedBackground.tsx
@app/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Implement prefers-reduced-motion support (CSS + JS)</name>
  <files>app/globals.css, app/components/AnimatedBackground.tsx</files>
  <action>
    **CSS layer (`app/globals.css`):**
    Add a `@media (prefers-reduced-motion: reduce)` block at the end of the mystery section styles:
    - Hide `.mystery-static` (canvas) — `display: none`
    - Hide `.mystery-flash-image` — `display: none`
    - Ensure `.mystery-content` remains fully visible and centered
    - Ensure `.mystery-container` has a solid dark background (not transparent/blank) so the page looks intentional without the canvas — use `background: #0a0a0a` or similar deep black
    - Ensure `.mystery-tagline` and `.mystery-logo` are clearly visible against the dark background

    **JS layer (`app/components/AnimatedBackground.tsx`):**
    At the top of each `useEffect` that sets up animations (canvas rendering, static intensity breathing, image flash sequence), check `window.matchMedia('(prefers-reduced-motion: reduce)').matches`. If true, return early — do NOT start `requestAnimationFrame` loops or `setInterval` timers.

    This is a belt-and-suspenders approach:
    - CSS hides the visual elements immediately (no FOUC)
    - JS prevents the animation loops from running at all (saves CPU/battery)

    Do NOT add a manual toggle or animation control — that's a v2 feature (INT-04 in REQUIREMENTS.md). This is purely respecting the OS-level accessibility setting.
  </action>
  <verify>
    - `npm run build` succeeds
    - In browser DevTools, enable "Emulate CSS media feature prefers-reduced-motion: reduce"
    - Verify: No canvas visible, no image flashing, STREET heading visible, tagline visible, form visible and functional
    - Verify: Page background is solid dark (not white/transparent)
    - Check browser DevTools Performance tab: no requestAnimationFrame activity when reduced-motion is active
  </verify>
  <done>
    - prefers-reduced-motion users see: dark background, STREET heading, "Something is coming." tagline, working waitlist form
    - No animations run (verified by absence of rAF calls)
    - CSS handles immediate visual state, JS prevents unnecessary computation
  </done>
</task>

<task type="auto">
  <name>Task 2: Verify final performance and accessibility baseline</name>
  <files>app/page.tsx</files>
  <action>
    Run final verification suite:

    1. **Build check**: `npm run build` — capture route sizes, confirm homepage < 150KB First Load JS
    2. **HTML check**: `curl localhost:3000` — confirm "STREET" and "Something is coming" present in raw HTML
    3. **Lint check**: `npm run lint` — no warnings or errors
    4. **Type check**: `npx tsc --noEmit` — no TypeScript errors

    If any check fails, fix the issue before proceeding.

    Document the baseline metrics for future reference:
    - Homepage First Load JS size (from build output)
    - Whether HTML contains semantic content (yes/no from curl check)
    - Any warnings from lint or type check
  </action>
  <verify>
    - `npm run build` passes, homepage < 150KB
    - `npm run lint` passes
    - `npx tsc --noEmit` passes
    - HTML source contains meaningful text
  </verify>
  <done>
    - All four requirements verified: PERF-01 (bundle), PERF-02 (LCP via server-rendered HTML), PERF-03 (reduced-motion), PERF-04 (meaningful HTML)
    - Performance baseline documented in SUMMARY.md
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds, homepage JS < 150KB
- [ ] `npm run lint` passes without errors
- [ ] `npx tsc --noEmit` passes without errors
- [ ] Reduced-motion: dark background, visible text, working form, no animations
- [ ] Normal mode: animations still work correctly (regression check)
- [ ] HTML source contains "STREET" and "Something is coming"
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Reduced-motion experience is complete and intentional
- All Phase 1 requirements met: PERF-01, PERF-02, PERF-03, PERF-04
- No regressions in normal (animation-enabled) mode
  </success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-02-SUMMARY.md`
</output>
